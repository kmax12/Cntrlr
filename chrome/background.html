<script>
	var cntrlrCrhomeEnabled = false;
	chrome.tabs.onUpdated.addListener(function (tabId, changeInfo, tab) {
		renderJS();
	});
	
	chrome.browserAction.onClicked.addListener(function(tab) {
		cntrlrCrhomeEnabled = !cntrlrCrhomeEnabled;
		renderJS();
	});
	
	function renderJS() {
		if(cntrlrCrhomeEnabled) {
			// chrome.tabs.executeScript(null, {file:"jquery.js"}, function () {
			// 				chrome.tabs.executeScript(null, {file:"http://localhost:8082/nowjs/now.js"}, function () {
			// 					chrome.tabs.executeScript(null, {file:"desktop.js"});
			// 				});
			// 			});
			// chrome.tabs.executeScript(null, {file:"jquery.js"}, function () {
			// 	setTimeout("chrome.tabs.executeScript(null, {code: \"var s = document.createElement('script');s.type='text/javascript';document.body.appendChild(s);s.src='http://localhost:8082/static/desktop.js';\"});", 200);
			// });
			// chrome.tabs.executeScript(null, {code: "var j = document.createElement('script');j.type='text/javascript';document.body.appendChild(j);j.src='https://ajax.googleapis.com/ajax/libs/jquery/1.6/jquery.min.js';var s = document.createElement('script');s.type='text/javascript';document.body.appendChild(s);s.src='http://localhost:8082/static/desktop.js';"});
			chrome.tabs.executeScript(null, {file:"load.js"});
			
			// setTimeout("chrome.tabs.executeScript(null, {code: \"var s = document.createElement('script');s.type='text/javascript';document.body.appendChild(s);s.src='http://localhost:8082/nowjs/now.js';});", 200);
			// setTimeout("chrome.tabs.executeScript(null, {code: \"var s = document.createElement('script');s.type='text/javascript';document.body.appendChild(s);s.src='http://localhost:8082/static/desktop.js';\"});", 600);
			chrome.browserAction.setBadgeBackgroundColor({color:[0, 200, 0, 100]});
		} else {
			chrome.browserAction.setBadgeBackgroundColor({color:[200, 0, 0, 100]});
		}
	};
	// chrome.tabs.executeScript(null, {file: "content_script.js"}); alert("hi");
	
	chrome.browserAction.setBadgeText({text: "  "});
	chrome.browserAction.setBadgeBackgroundColor({color:[200, 0, 0, 100]});

	// var i = 0;
	// window.setInterval(function() {
	// 	chrome.browserAction.setBadgeText({text:String(i)});
	// 	i++;
	// }, 10);
</script>